import{an as b,L as N,H as e,B as A,aq as y,K as R,ar as E,D as H,F as I}from"./chakra-n1sSkKQH.js";import{u as x,s as T,R as k,r as h,E as S,a as M,M as w,b as B,c as F,d as D,e as z,f as G,g as O,h as _}from"./index-oUEJVHya.js";import{l as j,u as v,o as V,r as g}from"./react-w_kKxQCt.js";import{u as C,R as Y}from"./pantone-input-jHW7SxBh.js";import{m as W}from"./ag-grid-react-rXg8_obN.js";import{u as P}from"./use-palette-o2eQaCTM.js";import{L as q}from"./line-detail-card-R0-UuVXx.js";import"./ag-grid-community-nIygpR5_.js";var K=function(n){var o=n.children,s=b().colorMode,r=N("RmgAgGrid");return e.jsx(A,{className:s==="light"?"ag-theme-alpine":"ag-theme-alpine-dark",sx:r,children:o})};function U(){const{t:n,i18n:o}=j(),s=C(),r=v(),{countryList:i,selectedCountry:f}=x(a=>a.app),u=i.map(a=>[a.id,s(a.name)]).sort((a,l)=>a[1].localeCompare(l[1],o.languages[0])).reduce((a,l)=>l[0]==="UN"?a:{...a,[l[0]]:l[1]},{"":n("Please select...")}),p=[{type:"select",label:n("Country/Region"),value:f,options:u,disabledOptions:[""],onChange:a=>r(T(a))}],m=()=>{h.openApp({appId:"rmg-palette-upload"}),h.event(S.ADD_CITY,{})};return e.jsxs(k,{children:[e.jsx(Y,{fields:p}),e.jsx(y,{ml:"auto",children:e.jsx(R,{variant:"solid",size:"sm",colorScheme:"primary",onClick:m,children:n("Add a city")})})]})}function J(n){const{city:o}=n,s=P(o),r=C();return e.jsx(y,{flexWrap:"wrap",sx:{"& .chakra-badge":{mb:1}},children:s.map(i=>e.jsx(M,{name:r(i.name),fg:i.fg||w.white,bg:i.colour},i.id))})}function Q(){const{t:n,i18n:o}=j(),s=C(),r=B();V();const{cityList:i,selectedCountry:f,sidePanelCity:u}=x(t=>t.app),p=i.filter(t=>t.country===f),m=g.useRef(null);g.useEffect(()=>{var t,d;u||(d=(t=m.current)==null?void 0:t.api)==null||d.deselectAll()},[u]);const a=g.useCallback(({api:t})=>{const d=t.getSelectedRows().map(L=>L.id);d.length===1?r(F(d[0])):r(D())},[]),l=g.useMemo(()=>[{headerName:n("City"),field:"name",valueFormatter:({value:t})=>s(t),comparator:(t,d)=>s(t).localeCompare(s(d),o.languages[0]),sortable:!0,sort:"asc",wrapText:!0,filter:!0},{headerName:n("Lines"),field:"id",cellRenderer:({value:t})=>e.jsx(J,{city:t}),flex:1,autoHeight:!0,resizable:!1}],[o.language]),c=g.useMemo(()=>({resizable:!0}),[]);return e.jsx(K,{children:e.jsx(W.AgGridReact,{ref:m,rowData:p,columnDefs:l,defaultColDef:c,getRowId:({data:t})=>t.id,headerHeight:36,rowHeight:36,suppressCellFocus:!0,suppressRowVirtualisation:!0,rowSelection:"single",debug:!1,onSelectionChanged:a})})}const X=410;function Z(){var a,l;const{t:n}=j(),o=v(),{sidePanelCity:s,cityList:r}=x(c=>c.app),i=P(s),u=C()((l=(a=r.find(c=>c.id===s))==null?void 0:a.name)!=null?l:{}),p=()=>{o(D())},m=async()=>{h.closeApp("rmg-palette-upload"),setTimeout(()=>{h.openApp({appId:"rmg-palette-upload",hash:"/new?city"+s})},200),h.event(S.EDIT_CITY,{city:s})};return e.jsxs(z,{isOpen:!!s,width:X,header:"Dummy header",children:[e.jsx(G,{onClose:p,children:u}),e.jsx(E,{spacing:.5,px:2,flex:1,overflowY:"auto",children:i.map(c=>{var d;const t={...c,nameEntity:Object.entries(c.name),fg:(d=c.fg)!=null?d:w.white};return e.jsx(q,{lineDetail:t,editable:!1},c.id)})}),e.jsx(H,{}),e.jsx(y,{p:1,children:e.jsx(R,{size:"sm",ml:"auto",onClick:m,children:n("Edit")})})]})}function ie(){const{isDataLoading:n}=x(o=>o.app);return e.jsxs(O,{children:[n&&e.jsx(_,{isIndeterminate:!0}),e.jsx(U,{}),e.jsxs(I,{flex:1,overflow:"hidden",position:"relative",children:[e.jsx(Q,{}),e.jsx(Z,{})]})]})}export{ie as default};
