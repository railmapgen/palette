import{aa as A,q as L,j as e,B as N,ad as C,p as R,ae as E,D as M,F as k}from"./chakra-msXNt8OT.js";import{u as x,s as I,R as H,r as h,E as w,a as T,M as S,b as G,c as B,d as b,e as F,f as O,g as z,h as _}from"./index-D8sICgzd.js";import{n as j,u as v,a as g}from"./react-gETzansC.js";import{u as y,R as V}from"./pantone-input-oFQ_qVdv.js";import{A as Y}from"./ag-grid-react-TfqUzp9m.js";import{u as D}from"./use-palette-b9zQ4u9t.js";import{M as W,v as q,w as U}from"./ag-grid-community-TcQKCcyM.js";import{L as J}from"./line-detail-card-dTvLZGro.js";var K=function(o){var n=o.children,s=A().colorMode,r=L("RmgAgGrid");return e.jsx(N,{className:s==="light"?"ag-theme-alpine":"ag-theme-alpine-dark",sx:r,children:n})};function Q(){const{t:o,i18n:n}=j(),s=y(),r=v(),{countryList:i,selectedCountry:f}=x(a=>a.app),u=i.map(a=>[a.id,s(a.name)]).sort((a,l)=>a[1].localeCompare(l[1],n.languages[0])).reduce((a,l)=>l[0]==="UN"?a:{...a,[l[0]]:l[1]},{"":o("Please select...")}),p=[{type:"select",label:o("Country/Region"),value:f,options:u,disabledOptions:[""],onChange:a=>r(I(a))}],m=()=>{h.openApp({appId:"rmg-palette-upload"}),h.event(w.ADD_CITY,{})};return e.jsxs(H,{children:[e.jsx(V,{fields:p}),e.jsx(C,{ml:"auto",children:e.jsx(R,{variant:"solid",size:"sm",colorScheme:"primary",onClick:m,children:o("Add a city")})})]})}function X(o){const{city:n}=o,s=D(n),r=y();return e.jsx(C,{flexWrap:"wrap",sx:{"& .chakra-badge":{mb:1}},children:s.map(i=>e.jsx(T,{name:r(i.name),fg:i.fg||S.white,bg:i.colour},i.id))})}W.registerModules([q]);U({theme:"legacy"});const Z={mode:"singleRow",checkboxes:!1,enableClickSelection:!0};function $(){const{t:o,i18n:n}=j(),s=y(),r=G(),{cityList:i,selectedCountry:f,sidePanelCity:u}=x(t=>t.app),p=i.filter(t=>t.country===f),m=g.useRef(null);g.useEffect(()=>{var t,d;u||(d=(t=m.current)==null?void 0:t.api)==null||d.deselectAll()},[u]);const a=g.useCallback(({api:t})=>{const d=t.getSelectedRows().map(P=>P.id);d.length===1?r(B(d[0])):r(b())},[]),l=g.useMemo(()=>[{headerName:o("City"),field:"name",valueFormatter:({value:t})=>s(t),comparator:(t,d)=>s(t).localeCompare(s(d),n.languages[0]),sortable:!0,sort:"asc",wrapText:!0,filter:!0},{headerName:o("Lines"),field:"id",cellRenderer:({value:t})=>e.jsx(X,{city:t}),flex:1,autoHeight:!0,resizable:!1}],[n.language]),c=g.useMemo(()=>({resizable:!0}),[]);return e.jsx(K,{children:e.jsx(Y,{ref:m,rowData:p,columnDefs:l,defaultColDef:c,getRowId:({data:t})=>t.id,headerHeight:36,rowHeight:36,suppressCellFocus:!0,suppressRowVirtualisation:!0,rowSelection:Z,debug:!1,onSelectionChanged:a})})}const ee=410;function te(){var a,l;const{t:o}=j(),n=v(),{sidePanelCity:s,cityList:r}=x(c=>c.app),i=D(s),u=y()((l=(a=r.find(c=>c.id===s))==null?void 0:a.name)!=null?l:{}),p=()=>{n(b())},m=async()=>{h.closeApp("rmg-palette-upload"),setTimeout(()=>{h.openApp({appId:"rmg-palette-upload",hash:"/new?city="+s})},200),h.event(w.EDIT_CITY,{city:s})};return e.jsxs(F,{isOpen:!!s,width:ee,header:"Dummy header",children:[e.jsx(O,{onClose:p,children:u}),e.jsx(E,{spacing:.5,px:2,flex:1,overflowY:"auto",children:i.map(c=>{var d;const t={...c,nameEntity:Object.entries(c.name),fg:(d=c.fg)!=null?d:S.white};return e.jsx(J,{lineDetail:t,editable:!1},c.id)})}),e.jsx(M,{}),e.jsx(C,{p:1,children:e.jsx(R,{size:"sm",ml:"auto",onClick:m,children:o("Edit")})})]})}function de(){const{isDataLoading:o}=x(n=>n.app);return e.jsxs(z,{children:[o&&e.jsx(_,{isIndeterminate:!0}),e.jsx(Q,{}),e.jsxs(k,{flex:1,overflow:"hidden",position:"relative",children:[e.jsx($,{}),e.jsx(te,{})]})]})}export{de as default};
