import{aa as L,q as A,n as e,B as N,ad as y,p as R,ae as E,D as I,F as H}from"./chakra-C7mz8WDx.js";import{u as x,s as T,R as k,r as h,E as S,a as M,M as w,b as B,c as F,d as D,e as z,f as G,g as O,h as _}from"./index-CgzWA51A.js";import{n as j,u as P,a as g}from"./react-Xm5uCCSw.js";import{u as C,R as V}from"./pantone-input-DVSAd4h8.js";import{A as Y}from"./ag-grid-react-CNkgX5ES.js";import{u as v}from"./use-palette-Ck-ngji8.js";import{L as W}from"./line-detail-card-Bh8yzOD0.js";import"./ag-grid-community-CKIXieJ7.js";var q=function(n){var o=n.children,s=L().colorMode,r=A("RmgAgGrid");return e.jsx(N,{className:s==="light"?"ag-theme-alpine":"ag-theme-alpine-dark",sx:r,children:o})};function U(){const{t:n,i18n:o}=j(),s=C(),r=P(),{countryList:i,selectedCountry:f}=x(a=>a.app),u=i.map(a=>[a.id,s(a.name)]).sort((a,l)=>a[1].localeCompare(l[1],o.languages[0])).reduce((a,l)=>l[0]==="UN"?a:{...a,[l[0]]:l[1]},{"":n("Please select...")}),m=[{type:"select",label:n("Country/Region"),value:f,options:u,disabledOptions:[""],onChange:a=>r(T(a))}],p=()=>{h.openApp({appId:"rmg-palette-upload"}),h.event(S.ADD_CITY,{})};return e.jsxs(k,{children:[e.jsx(V,{fields:m}),e.jsx(y,{ml:"auto",children:e.jsx(R,{variant:"solid",size:"sm",colorScheme:"primary",onClick:p,children:n("Add a city")})})]})}function J(n){const{city:o}=n,s=v(o),r=C();return e.jsx(y,{flexWrap:"wrap",sx:{"& .chakra-badge":{mb:1}},children:s.map(i=>e.jsx(M,{name:r(i.name),fg:i.fg||w.white,bg:i.colour},i.id))})}function K(){const{t:n,i18n:o}=j(),s=C(),r=B(),{cityList:i,selectedCountry:f,sidePanelCity:u}=x(t=>t.app),m=i.filter(t=>t.country===f),p=g.useRef(null);g.useEffect(()=>{var t,d;u||(d=(t=p.current)==null?void 0:t.api)==null||d.deselectAll()},[u]);const a=g.useCallback(({api:t})=>{const d=t.getSelectedRows().map(b=>b.id);d.length===1?r(F(d[0])):r(D())},[]),l=g.useMemo(()=>[{headerName:n("City"),field:"name",valueFormatter:({value:t})=>s(t),comparator:(t,d)=>s(t).localeCompare(s(d),o.languages[0]),sortable:!0,sort:"asc",wrapText:!0,filter:!0},{headerName:n("Lines"),field:"id",cellRenderer:({value:t})=>e.jsx(J,{city:t}),flex:1,autoHeight:!0,resizable:!1}],[o.language]),c=g.useMemo(()=>({resizable:!0}),[]);return e.jsx(q,{children:e.jsx(Y,{ref:p,rowData:m,columnDefs:l,defaultColDef:c,getRowId:({data:t})=>t.id,headerHeight:36,rowHeight:36,suppressCellFocus:!0,suppressRowVirtualisation:!0,rowSelection:"single",debug:!1,onSelectionChanged:a})})}const Q=410;function X(){var a,l;const{t:n}=j(),o=P(),{sidePanelCity:s,cityList:r}=x(c=>c.app),i=v(s),u=C()((l=(a=r.find(c=>c.id===s))==null?void 0:a.name)!=null?l:{}),m=()=>{o(D())},p=async()=>{h.closeApp("rmg-palette-upload"),setTimeout(()=>{h.openApp({appId:"rmg-palette-upload",hash:"/new?city="+s})},200),h.event(S.EDIT_CITY,{city:s})};return e.jsxs(z,{isOpen:!!s,width:Q,header:"Dummy header",children:[e.jsx(G,{onClose:m,children:u}),e.jsx(E,{spacing:.5,px:2,flex:1,overflowY:"auto",children:i.map(c=>{var d;const t={...c,nameEntity:Object.entries(c.name),fg:(d=c.fg)!=null?d:w.white};return e.jsx(W,{lineDetail:t,editable:!1},c.id)})}),e.jsx(I,{}),e.jsx(y,{p:1,children:e.jsx(R,{size:"sm",ml:"auto",onClick:p,children:n("Edit")})})]})}function re(){const{isDataLoading:n}=x(o=>o.app);return e.jsxs(O,{children:[n&&e.jsx(_,{isIndeterminate:!0}),e.jsx(U,{}),e.jsxs(H,{flex:1,overflow:"hidden",position:"relative",children:[e.jsx(K,{}),e.jsx(X,{})]})]})}export{re as default};
